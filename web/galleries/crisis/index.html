<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Crisis - Wubbleton Sacred Art</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
            background: #FFFFFF;
            color: #333;
        }
        
        /* Full screen header */
        .hero {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #000;
        }
        
        .hero-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        .hero-image.loaded {
            opacity: 1;
        }
        
        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .hero-title {
            font-size: 5em;
            font-weight: bold;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            text-align: center;
        }
        
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            font-size: 14px;
            z-index: 100;
            background: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 30px;
            transition: background 0.3s;
        }
        
        .back-link:hover {
            background: rgba(0,0,0,0.8);
        }
        
        .description {
            max-width: 800px;
            margin: 80px auto;
            padding: 0 20px;
            text-align: center;
            color: #555;
            line-height: 1.8;
            font-size: 1.1em;
        }
        
        /* Gallery with masonry layout */
        .gallery-container {
            padding: 0 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .gallery {
            column-count: 2;
            column-gap: 20px;
            width: 100%;
        }
        
        @media (max-width: 768px) {
            .gallery {
                column-count: 1;
            }
            .hero-title {
                font-size: 3em;
            }
        }
        
        .img-wrapper {
            break-inside: avoid;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            margin-bottom: 20px;
            background: #f5f5f5;
            border-radius: 8px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .img-wrapper.loaded {
            opacity: 1;
            transform: translateY(0);
        }
        
        .img-wrapper img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 8px;
            transition: transform 0.3s ease;
        }
        
        .img-wrapper:hover img {
            transform: scale(1.02);
        }
        
        /* Loading skeleton */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
            min-height: 300px;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .lightbox.active {
            opacity: 1;
        }
        
        .lightbox img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            max-width: 90%;
            max-height: 90%;
            transition: transform 0.3s ease;
        }
        
        .lightbox.active img {
            transform: translate(-50%, -50%) scale(1);
        }
        
        .close {
            position: absolute;
            top: 20px;
            right: 40px;
            font-size: 40px;
            color: white;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s;
        }
        
        .close:hover {
            opacity: 1;
        }
        
        /* Floating emojis */
        .emoji {
            position: fixed;
            font-size: 20px;
            animation: float-up 15s linear infinite;
            pointer-events: none;
            z-index: 1;
            opacity: 0.6;
        }
        
        @keyframes float-up {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <a href="../../" class="back-link">‚Üê Back to Wubbleton</a>
    
    <div class="hero">
        <img class="hero-image" id="hero-image" src="" alt="The Crisis">
        <div class="hero-overlay">
            <h1 class="hero-title">THE CRISIS</h1>
        </div>
    </div>
    
    <div class="description">
        <p>156 visions of abandoned altars and fragmented symbols. These works capture the exact moment when the old gods stopped answering, when ritual became routine, when the sacred dissolved into silicon. Each piece is a forensic photograph of spiritual crime scenes‚Äîempty churches filled with charging cables, prayer apps with push notifications, meditation subscriptions auto-renewing into the void.</p>
    </div>
    
    <div class="gallery-container">
        <div class="gallery" id="gallery">
            <!-- Images will be added by JavaScript -->
        </div>
    </div>
    
    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <span class="close">&times;</span>
        <img id="lightbox-img" src="" alt="">
    </div>
    
    <script>
        // Supabase configuration
        const SUPABASE_URL = 'https://ozxhahlykxeeiuvmzrbb.supabase.co';
        const BUCKET_NAME = 'gallery-images';
        
        // Function to get Supabase URL
        function getSupabaseUrl(path) {
            return `${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/${path}`;
        }
        
        // Create floating emojis
        function createEmoji() {
            const emojis = ['üíÄ', '‚ö°', 'üî•', 'üëÅÔ∏è', 'üåë', '‚ö∞Ô∏è', 'üïØÔ∏è', '‚õìÔ∏è'];
            const emoji = document.createElement('div');
            emoji.className = 'emoji';
            emoji.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
            emoji.style.left = Math.random() * 100 + '%';
            emoji.style.animationDuration = Math.random() * 10 + 15 + 's';
            emoji.style.animationDelay = Math.random() * 5 + 's';
            document.body.appendChild(emoji);
            
            setTimeout(() => emoji.remove(), 25000);
        }
        
        // Create emojis periodically
        setInterval(createEmoji, 3000);
        
        // Crisis gallery images - actual files from directory
        const images = [
            '1.jpg', '100.jpg', '100d.jpg', '101.jpg', '102.jpg', '103.jpg', '104.jpg', '105d.jpg', '106.jpg', '109.jpg',
            '11.jpg', '110.jpg', '110d.jpg', '111.jpg', '112.jpg', '113.jpg', '114.jpg', '114b.jpg', '114c.jpg', '115.jpg',
            '115d.jpg', '116.jpg', '117.jpg', '118.jpg', '119.jpg', '11b.jpg', '11d.jpg', '12.jpg', '120.jpg', '120d.jpg',
            '121.jpg', '122.jpg', '125.jpg', '127.jpg', '129.jpg', '129d.jpg', '13.jpg', '131.jpg', '133.jpg', '134.jpg',
            '135b.jpg', '136.jpg', '137.jpg', '139d.jpg', '145.jpg', '148.jpg', '15.jpg', '151.jpg', '157.jpg', '159.jpg',
            '15b.jpg', '16.jpg', '161.jpg', '163.jpg', '164.jpg', '165.jpg', '167.jpg', '16b.jpg', '170.jpg', '173.jpg',
            '175.jpg', '178.jpg', '179.jpg', '18.jpg', '181.jpg', '182.jpg', '184.jpg', '187.jpg', '188.jpg', '190.jpg',
            '191.jpg', '193.jpg', '195.jpg', '196.jpg', '197.jpg', '198.jpg', '20.jpg', '2000.jpg', '201.jpg', '202.jpg',
            '203.jpg', '204.jpg', '206.jpg', '207.jpg', '208.jpg', '209.jpg', '21.jpg', '210.jpg', '211.jpg', '212.jpg',
            '213.jpg', '215.jpg', '216.jpg', '217.jpg', '218.jpg', '220.jpg', '222.jpg', '223.jpg', '225.jpg', '226.jpg',
            '227.jpg', '230.jpg', '232.jpg', '234.jpg', '235.jpg', '236.jpg', '237.jpg', '239.jpg', '240.jpg', '242.jpg',
            '243.jpg', '244.jpg', '245.jpg', '246.jpg', '249.jpg', '25.jpg', '26.jpg', '26b.jpg', '27b.jpg', '27c.jpg',
            '28.jpg', '28d.jpg', '30b.jpg', '32.jpg', '33.jpg', '35.jpg', '35a.jpg', '35b.jpg', '35b1.jpg', '36.jpg',
            '37.jpg', '39.jpg', '39b.jpg', '39c.jpg', '4.jpg', '40.jpg', '40b.jpg', '41.jpg', '42.jpg', '43.jpg',
            '44.jpg', '46.jpg', '47.jpg', '47b.jpg', '48.jpg', '49.jpg', '5.jpg', '50.jpg', '50b.jpg', '52.jpg',
            '53.jpg', '54.jpg', '55.jpg', '57.jpg', '58b.jpg', '59.jpg', '6.jpg', '60b.jpg', '61.jpg', '62.jpg',
            '63.jpg', '64.jpg', '64d.jpg', '65.jpg', '67.jpg', '68.jpg', '69.jpg', '69b.jpg', '7.jpg', '70.jpg',
            '701.jpg', '70b.jpg', '75.jpg', '75d.jpg', '76.jpg', '76b.jpg', '77.jpg', '78.jpg', '79d.jpg', '8.jpg',
            '80.jpg', '81.jpg', '82.jpg', '84.jpg', '85.jpg', '86.jpg', '87.jpg', '88.jpg', '89.jpg', '9.jpg',
            '90.jpg', '91.jpg', '92.jpg', '93.jpg', '94.jpg', '95.jpg', '96.jpg', '97.jpg', '97d.jpg', '98.jpg',
            '99.jpg', 'b.jpg', 'c.jpg', 'd.jpg', 'd1.jpg', 'e.jpg', 'f.jpg', 'g.jpg', 'h.jpg', 'i.jpg', 'j.jpg',
            'k.jpg', 'l.jpg', 'm.jpg', 'n.jpg', 'o.jpg', 'p.jpg', 'y.jpg'
        ];
        
        // Load hero image
        const heroImage = document.getElementById('hero-image');
        const heroImageUrl = getSupabaseUrl(`crisis/full/${images[Math.floor(Math.random() * images.length)]}`);
        heroImage.src = heroImageUrl;
        heroImage.onload = () => heroImage.classList.add('loaded');
        
        const gallery = document.getElementById('gallery');
        
        // Preload images and create gallery items with better loading
        function loadImage(img, index) {
            return new Promise((resolve) => {
                const wrapper = document.createElement('div');
                wrapper.className = 'img-wrapper';
                
                // Add skeleton loader
                const skeleton = document.createElement('div');
                skeleton.className = 'skeleton';
                skeleton.style.height = Math.random() * 200 + 300 + 'px';
                wrapper.appendChild(skeleton);
                
                const imgElement = document.createElement('img');
                const imageUrl = getSupabaseUrl(`crisis/full/${img}`); // Use full size images
                
                // Preload image
                const tempImg = new Image();
                tempImg.onload = () => {
                    imgElement.src = imageUrl;
                    imgElement.alt = `Crisis ${index + 1}`;
                    imgElement.onclick = () => openLightbox(imageUrl);
                    
                    // Replace skeleton with image
                    wrapper.removeChild(skeleton);
                    wrapper.appendChild(imgElement);
                    
                    // Trigger animation with delay
                    setTimeout(() => {
                        wrapper.classList.add('loaded');
                    }, index * 30);
                    
                    resolve();
                };
                
                tempImg.src = imageUrl;
                gallery.appendChild(wrapper);
            });
        }
        
        // Load images in batches for better performance
        async function loadGallery() {
            const batchSize = 10;
            for (let i = 0; i < images.length; i += batchSize) {
                const batch = images.slice(i, i + batchSize);
                const promises = batch.map((img, idx) => loadImage(img, i + idx));
                await Promise.all(promises);
            }
        }
        
        // Start loading gallery
        loadGallery();
        
        function openLightbox(src) {
            const lightbox = document.getElementById('lightbox');
            lightbox.style.display = 'block';
            document.getElementById('lightbox-img').src = src;
            document.body.style.overflow = 'hidden';
            
            // Trigger animation
            setTimeout(() => {
                lightbox.classList.add('active');
            }, 10);
        }
        
        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
            
            setTimeout(() => {
                lightbox.style.display = 'none';
                document.body.style.overflow = 'auto';
            }, 300);
        }
        
        // Escape key to close
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeLightbox();
        });
    </script>
</body>
</html> 